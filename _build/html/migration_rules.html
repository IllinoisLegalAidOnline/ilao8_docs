

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Custom Rules &mdash; ILAO Drupal 8 3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OTIS Drupal 8" href="otis_drupal8.html" />
    <link rel="prev" title="Contexts" href="migration_contexts.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ILAO Drupal 8
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="migration.html">Migration Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="migration_users.html">Users and user profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_org_data.html">Migrating Organization Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_otis_entities.html">OTIS-related migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_legal_content_types.html">Legal content migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_portal_pages.html">Portal content</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_toolboxes.html">Toolboxes and related structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_events.html">Event nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_jobs.html">Job content types</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_internships.html">Internships content type</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_blog.html">Migration Blog Posts</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_basic_pages.html">Basic page content type</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_other_node_types.html">Other node types</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_search.html">Search migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_reporting.html">Views/Reporting Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_seo.html">Migration: SEO features</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_google_analytics.html">Google analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_sms.html">SMS and Twilio integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_zendesk.html">Zendesk Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_livechat.html">Livechat Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_translation.html">Translation</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_mailchimp.html">Mailchimp Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_discussion_groups.html">Discussion groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_contexts.html">Contexts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Custom Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rules-to-be-deleted">Rules to be deleted</a></li>
<li class="toctree-l3"><a class="reference internal" href="#content-management-rules">Content Management Rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#portal-content-needs-re-translated">Portal Content needs re-translated</a></li>
<li class="toctree-l4"><a class="reference internal" href="#content-needs-re-translated">Content needs re-translated</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notify-legal-comments">Notify legal comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unpublish-inappropriate-comments">Unpublish inappropriate comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-mail-on-creating-events-and-indicates-recording">Send mail on creating events and indicates recording</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-mail-on-updating-events-and-indicates-recording">Send mail on updating events and indicates recording</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-mail-on-adrm-content-update">Send mail on adrm content update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-management-rules">User Management Rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#law-students-get-pro-bono-automatically">Law students get pro bono automatically</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-user-to-group-based-on-email">Add user to group based on email</a></li>
<li class="toctree-l4"><a class="reference internal" href="#email-upon-validating-account">Email upon validating account</a></li>
<li class="toctree-l4"><a class="reference internal" href="#legal-aid-member-role-organization-grant">Legal Aid Member Role Organization Grant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#legal-self-help-center-navigator-role-organization-grant">Legal self help center navigator Role Organization Grant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#revoke-og-memberships-if-legal-self-help-center-navigator-role-is-lost">Revoke OG memberships if Legal self-help center navigator Role is lost</a></li>
<li class="toctree-l4"><a class="reference internal" href="#revoke-og-memberships-if-legal-aid-member-role-is-lost">Revoke OG memberships if Legal aid member Role is lost</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-anonymous-access-to-user-profiles">Block anonymous access to user profiles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#otis-related-rules">OTIS-related Rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#send-email-to-site-architect-upon-updating-intake-settings">Send Email to Site Architect upon updating Intake Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-email-to-site-architect-upon-updating-triage-rules">Send Email to Site Architect upon updating Triage Rules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-components">Rule Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rule-plugins">Rule plugins</a></li>
<li class="toctree-l4"><a class="reference internal" href="#action-plugins">Action plugins</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-ticklers">Send ticklers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rules-in-code">Rules in Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ilao-events-module">ilao_events module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ilao-sms-surveys">ilao_sms_surveys</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ilao-toolbox">ilao_toolbox</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ilao-user-utilities">ilao_user_utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ilao-workbench">ilao_workbench</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="otis_drupal8.html">OTIS Drupal 8</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO Drupal 8</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="migration.html">Migration Documentation</a> &raquo;</li>
        
      <li>Custom Rules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/migration_rules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="custom-rules">
<h1>Custom Rules<a class="headerlink" href="#custom-rules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rules-to-be-deleted">
<h2>Rules to be deleted<a class="headerlink" href="#rules-to-be-deleted" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>all inactive rules</li>
<li>support ticket response - legal help (spanish)</li>
<li>test og</li>
<li>content updated by advocates (currently emails stephanie)</li>
<li>create ticket for sent email</li>
<li>email link to registration to contact of event</li>
<li>email link to registration to creator of event</li>
<li>email site architect on landing page creation</li>
<li>Notify content team on edit</li>
<li>Route support requests</li>
<li>Save service practice area from legal category</li>
<li>Stop registrations</li>
<li>Subscribe Community engagement users to Opportunity node type</li>
<li>Subscribe to bugs</li>
<li>Subscribe users to support ticket - Admin</li>
<li>Subscribe users to support ticket - Bugs</li>
<li>Subscribe users to support ticket - Community</li>
<li>Subscribe users to support ticket - Fundraising</li>
<li>Subscribe users to support ticket - Intern</li>
<li>Subscribe users to support ticket - Live Help</li>
<li>Subscribe users to support ticket - Media</li>
<li>Subscribe users to support ticket - UX</li>
<li>Subscribe users to support ticket - YPB</li>
<li>Subscribe UX users to FAQ node type</li>
<li>Support ticket response - Account</li>
<li>Support ticket response - Closing message</li>
<li>Support ticket response - General redirect</li>
<li>Support ticket response - legal help</li>
<li>Support ticket response - LSHC redirect</li>
<li>test</li>
<li>ticket comment state defaults</li>
<li>ticket comment client defaults</li>
<li>ticket comment assignee defaults</li>
<li>ticket comment priority defaults</li>
</ul>
</div>
<div class="section" id="content-management-rules">
<h2>Content Management Rules<a class="headerlink" href="#content-management-rules" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Can the re-translation rules be combined?</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If we delete the field-translation-outdated field and go with the core fields, the retrnaslation rules would need to be updated</p>
</div>
<div class="section" id="portal-content-needs-re-translated">
<h3>Portal Content needs re-translated<a class="headerlink" href="#portal-content-needs-re-translated" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  after updating existing content type Portal main page
When: field-translation-outdated is true and the prior value wasn’t true
Then:
Sends an HTML email to <a class="reference external" href="mailto:translationmgmt&#37;&#52;&#48;illinoislegalaid&#46;org">translationmgmt<span>&#64;</span>illinoislegalaid<span>&#46;</span>org</a> with the subject of “Translation needs updated: node:title]” and a body of [node:title] (Node ID:  [node:nid]) has been flagged as needing its translations updated.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If we delete the field-translation-outdated field and go with the core fields, this rule needs updated</p>
</div>
</div>
<div class="section" id="content-needs-re-translated">
<h3>Content needs re-translated<a class="headerlink" href="#content-needs-re-translated" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  after updating existing content type Legal content
When: field-translation-outdated is true and the prior value wasn’t true
Then:
Sends an HTML email to <a class="reference external" href="mailto:translationmgmt&#37;&#52;&#48;illinoislegalaid&#46;org">translationmgmt<span>&#64;</span>illinoislegalaid<span>&#46;</span>org</a> with the subject of “Translation needs updated: node:title]” and a body of [node:title] (Node ID:  [node:nid]) has been flagged as needing its translations updated.</p>
</div>
<div class="section" id="notify-legal-comments">
<h3>Notify legal comments<a class="headerlink" href="#notify-legal-comments" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  when a new comment is saved
Condition: User is not anonymous
Then:  Sends an email to <a class="reference external" href="mailto:contentteam&#37;&#52;&#48;illinoislegalaid&#46;org">contentteam<span>&#64;</span>illinoislegalaid<span>&#46;</span>org</a> with message of &lt;p&gt;A new comment by [comment:name]/[comment:mail] was just posted&lt;/p&gt;
[comment:body]
&lt;p&gt;The comment can be found here:  [comment:url]&lt;/p&gt;</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Should not trigger if the user has the staff role</p>
</div>
</div>
<div class="section" id="unpublish-inappropriate-comments">
<h3>Unpublish inappropriate comments<a class="headerlink" href="#unpublish-inappropriate-comments" title="Permalink to this headline">¶</a></h3>
<p>Triggers: when a comment is flagged as inappropriate
Condtion:  count of inappropriate flags is 3 or more
Action: Unpublishes the comment</p>
</div>
<div class="section" id="send-mail-on-creating-events-and-indicates-recording">
<h3>Send mail on creating events and indicates recording<a class="headerlink" href="#send-mail-on-creating-events-and-indicates-recording" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  When saving a new event
When:  User does not indicates that they do not want an event recorded
Then: Sends an email to all users with the content manager role with a subject of [node:title]: Event recording notification and a body of he following event on [node:field-start-date:value] is set to be recorded. Please follow up with the sponsoring organization. Event details: [node:url]</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Should send to the contnet managers gmail account, not role-based</p>
</div>
</div>
<div class="section" id="send-mail-on-updating-events-and-indicates-recording">
<h3>Send mail on updating events and indicates recording<a class="headerlink" href="#send-mail-on-updating-events-and-indicates-recording" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  When updating an event
When:  User does not indicates that they do not want an event recorded and this and previously had indicated that they did not want the event recorded
Then: Sends an email to all users with the content manager role with a subject of [node:title]: Event recording notification and a body of he following event on [node:field-start-date:value] is set to be recorded. Please follow up with the sponsoring organization. Event details: [node:url]</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">Should send to the contnet managers gmail account, not role-based</p>
</div>
</div>
<div class="section" id="send-mail-on-adrm-content-update">
<h3>Send mail on adrm content update<a class="headerlink" href="#send-mail-on-adrm-content-update" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  When an ADRM content is updated
Conditions:  The user does not have the content manager role; the user has the legal aid member or SME role
Action:  Sends email to all users with the content manager role
with a subject line of Attorney manual [node:title]
and subject of: The attorney manual [node:title] has been updated by [node:current-revision-author-name]. Please review: [node:url]</p>
</div>
</div>
<div class="section" id="user-management-rules">
<h2>User Management Rules<a class="headerlink" href="#user-management-rules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="law-students-get-pro-bono-automatically">
<h3>Law students get pro bono automatically<a class="headerlink" href="#law-students-get-pro-bono-automatically" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  After saving a new user account
Condition:  Email address contains .edu
Then:  Adds the role of Law student member to account</p>
</div>
<div class="section" id="add-user-to-group-based-on-email">
<h3>Add user to group based on email<a class="headerlink" href="#add-user-to-group-based-on-email" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  After updating an existing user account
Condition:  User has legal aid member role AND email is not empty
Then: no action</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Need to evaluate</p>
</div>
</div>
<div class="section" id="email-upon-validating-account">
<h3>Email upon validating account<a class="headerlink" href="#email-upon-validating-account" title="Permalink to this headline">¶</a></h3>
<p>Purpose is to get user to complete a user testing demographics survey</p>
<p>Triggers: When user logs in for the first time
Then: Send an HTML email with a subject of “Help improve IllinoisLegalAid.org”
and a body of “Thank you for expressing an interest in participating in user research activities to help improve IllinoisLegalAid.org. Please take &lt;a href=”<a class="reference external" href="https://www.surveymonkey.com/r/?sm=0dJuQigsoARhzLV8oPf3EmVTgBKyM664pn2IwhSkZbU_3D">https://www.surveymonkey.com/r/?sm=0dJuQigsoARhzLV8oPf3EmVTgBKyM664pn2IwhSkZbU_3D</a>” rel=”noopener” target=”_blank”&gt;this short survey&lt;/a&gt;, so that we know which types of user research opportunities to share with you. If you are no longer interested in participating, log in to IllinoisLegalAid.org and update your preferences. Thanks for your time!”</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This should check that the user opted in to user test but doesn’t</p>
</div>
</div>
<div class="section" id="legal-aid-member-role-organization-grant">
<h3>Legal Aid Member Role Organization Grant<a class="headerlink" href="#legal-aid-member-role-organization-grant" title="Permalink to this headline">¶</a></h3>
<p>Purpose is to associate a legal aid user with an organization when they create or update their account</p>
<p>Triggers:  User updates an existing account or saves a new account
When:  Legal aid affiliation field is not empty AND user is not a group member AND user has the legal aid member role OR (current user is ILAO staff and email domain matches an organization domain
Actions:  Add the user to the organic group of the organization associated with the organization domain</p>
<p>Relies on:  ilao_user_utilities to define the condition.</p>
</div>
<div class="section" id="legal-self-help-center-navigator-role-organization-grant">
<h3>Legal self help center navigator Role Organization Grant<a class="headerlink" href="#legal-self-help-center-navigator-role-organization-grant" title="Permalink to this headline">¶</a></h3>
<p>Purpose is to associate a legal aid user with an organization when they create or update their account</p>
<p>Triggers:  User updates an existing account or saves a new account
When:  User has the legal self help center role
Actions:  Add the user to the organic group of the organization associated with the organization domain</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Why are these 2 organization grants so different?</p>
</div>
</div>
<div class="section" id="revoke-og-memberships-if-legal-self-help-center-navigator-role-is-lost">
<h3>Revoke OG memberships if Legal self-help center navigator Role is lost<a class="headerlink" href="#revoke-og-memberships-if-legal-self-help-center-navigator-role-is-lost" title="Permalink to this headline">¶</a></h3>
<p>Triggers; when an existing user account is updated
When: user had the LSHC role and now does not
Then: Revokes OG memebership in LSHC organization and display a message on screen that says Revoked membership in [og-user-node-list:title] group for [account:name]</p>
</div>
<div class="section" id="revoke-og-memberships-if-legal-aid-member-role-is-lost">
<h3>Revoke OG memberships if Legal aid member Role is lost<a class="headerlink" href="#revoke-og-memberships-if-legal-aid-member-role-is-lost" title="Permalink to this headline">¶</a></h3>
<p>Triggers; when an existing user account is updated
When: user had the legal aid member role and now does not
Then: Revokes OG memebership in LSHC organization and display a message on screen that says Revoked membership in [og-user-node-list:title] group for [account:name]</p>
</div>
<div class="section" id="block-anonymous-access-to-user-profiles">
<h3>Block anonymous access to user profiles<a class="headerlink" href="#block-anonymous-access-to-user-profiles" title="Permalink to this headline">¶</a></h3>
<p>Triggers: User account page is viewed
When:  Current user has the anonymous role
Then: Redirect to node/85641 (access denied)</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">URL may change with migration</p>
</div>
</div>
</div>
<div class="section" id="otis-related-rules">
<h2>OTIS-related Rules<a class="headerlink" href="#otis-related-rules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="send-email-to-site-architect-upon-updating-intake-settings">
<h3>Send Email to Site Architect upon updating Intake Settings<a class="headerlink" href="#send-email-to-site-architect-upon-updating-intake-settings" title="Permalink to this headline">¶</a></h3>
<p>Triggers:  when an intake settings entity is created or updated
Condition: User is not a site architect or anonymous
Then Sends an HTML email with a subject of Intake Settings updated or added at [site:name] and a body of: &lt;p&gt;[site:current-user] has added or updated the following Intake Settings &lt;a href=”/admin/intake/[oas-intake-settings:intake-settings-id]/edit”&gt;[oas-intake-settings:name]&lt;/a&gt;.&lt;/p&gt;</p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Rule needs cleaned in Drupal 7 to send to <a class="reference external" href="mailto:otissupport&#37;&#52;&#48;illinoislegalaid&#46;org">otissupport<span>&#64;</span>illinoislegalaid<span>&#46;</span>org</a> rather than site architect.</p>
</div>
</div>
<div class="section" id="send-email-to-site-architect-upon-updating-triage-rules">
<h3>Send Email to Site Architect upon updating Triage Rules<a class="headerlink" href="#send-email-to-site-architect-upon-updating-triage-rules" title="Permalink to this headline">¶</a></h3>
<p>Trigger:  When an existing triage rule content is updated
Condition: And the user does not have the site architect role
Then:  Sends an html email to otissupport with a subject of Triage rules updated or added at [site:name] and body of Please edit the triage rules for node [node:nid] to enable the translation settings:
1) Add translations for each language
2) Enable string translation in the webform
3) Go to translate interface and filter on webform localization and add the translations using Google translate.</p>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">Rule needs cleaned in Drupal 7 to reflect only edited triage rules</p>
</div>
</div>
</div>
<div class="section" id="rule-components">
<h2>Rule Components<a class="headerlink" href="#rule-components" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rule-plugins">
<h3>Rule plugins<a class="headerlink" href="#rule-plugins" title="Permalink to this headline">¶</a></h3>
<p>The following are all added and defined by the Scheduler contributed module:</p>
<ul class="simple">
<li>Set scheduled publishing date</li>
<li>Set scheduled unpublishing date</li>
<li>Remove scheduled publishing date</li>
<li>Remove scheduled unpublishing date</li>
</ul>
</div>
<div class="section" id="action-plugins">
<h3>Action plugins<a class="headerlink" href="#action-plugins" title="Permalink to this headline">¶</a></h3>
<p>Do not migrate:
* Create email ticket record
* Support client mapping</p>
<div class="section" id="potential-problem-with-etransfers">
<h4>Potential problem with eTransfers<a class="headerlink" href="#potential-problem-with-etransfers" title="Permalink to this headline">¶</a></h4>
<p>Sends an html email to site architects with a subject of “Potential problem: No etransfers in 2 days” and body of “The system hasn’t recorded any online intakes being transferred to a CMS in 2 days. Please check the system.”</p>
</div>
<div class="section" id="potential-problem-with-surveys">
<h4>Potential problem with surveys<a class="headerlink" href="#potential-problem-with-surveys" title="Permalink to this headline">¶</a></h4>
<p>Sends an html email to site architects with a subject of “Potential problem: [surveys:title] hasn’t been collecting data.” and a body of “The following survey [surveys:title] at [surveys:url] has not had a completed survey in 3 days. Please check the system.”</p>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p class="last">Evaluate whether this is needed in light of surveys generally</p>
</div>
</div>
<div class="section" id="content-management-notifications">
<h4>Content management notifications<a class="headerlink" href="#content-management-notifications" title="Permalink to this headline">¶</a></h4>
<p>These 3 action plugins send emails to users when content changes workbench states and are fired in the ilao_workbench module.  They plugins accept 3 variables:</p>
<ul class="simple">
<li>the roles list of who to send the email to</li>
<li>the node that was edited</li>
<li>the user who made the edits</li>
</ul>
<p>Roles that receive these are any that have the “receive workbench transition alerts” permission.</p>
</div>
<div class="section" id="send-content-copy-edit-notification">
<h4>Send content copy edit notification<a class="headerlink" href="#send-content-copy-edit-notification" title="Permalink to this headline">¶</a></h4>
<p>Sends an email to all users of the provided roles with a subject of “[node:title] is ready for copy edit” and body of:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">The &lt;a href=&quot;[node:url]&quot;&gt;[node:title]&lt;/a&gt; has been updated and is ready for copy edit</span>
<span class="x">The content, [&lt;a href=&quot;[node:url]&quot;&gt;[node:title]&lt;/a&gt; has been edited and is &lt;a</span>
<span class="x">href=&quot;[node:edit-url]&quot;&gt;ready for review&lt;/a&gt;. The content was updated by [user:name].</span>
</pre></div>
</div>
</div>
<div class="section" id="send-content-review-notification">
<h4>Send content review notification<a class="headerlink" href="#send-content-review-notification" title="Permalink to this headline">¶</a></h4>
<p>Sends an email to all users of the provided roles with a subject of “[node:title] is ready for review” and body of:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">The &lt;a href=&quot;[node:url]&quot;&gt;[node:title]&lt;/a&gt; has been updated and is ready to be reviewed.</span>
<span class="x">The content, [&lt;a href=&quot;[node:url]&quot;&gt;[node:title]&lt;/a&gt; has been edited and is</span>
<span class="x">&lt;a href=&quot;[node:edit-url]&quot;&gt;ready for review&lt;/a&gt;. The content was updated by [user:name].</span>
</pre></div>
</div>
</div>
<div class="section" id="send-publish-notificationn">
<h4>Send publish notificationn<a class="headerlink" href="#send-publish-notificationn" title="Permalink to this headline">¶</a></h4>
<p>Sends an email to all users of the provided roles with a subject of “An unreviewed update to [node:title] has been published.” and body of:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">[user:name] just published a revision for &lt;a href=&quot;[node:url]&quot;&gt;[node:title]&lt;/a&gt; on the</span>
<span class="x">website.  This revision was not reviewed by ILAO staff prior to publication.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="send-ticklers">
<h3>Send ticklers<a class="headerlink" href="#send-ticklers" title="Permalink to this headline">¶</a></h3>
<p>There are 2 components that are used by the ilao_toolbox module to send tickler messages.</p>
<div class="section" id="send-email-on-ticklr">
<h4>Send email on ticklr<a class="headerlink" href="#send-email-on-ticklr" title="Permalink to this headline">¶</a></h4>
<p>Sends a tickler email for a toolbox tool step to a specific user and logs the email sent to the toolbox tickler entity.</p>
</div>
<div class="section" id="send-sms-on-tickler">
<h4>Send sms on tickler<a class="headerlink" href="#send-sms-on-tickler" title="Permalink to this headline">¶</a></h4>
<p>Sends an sms to a number over Twilio and logs the sms sent to the toolbox tickler entity</p>
</div>
</div>
</div>
<div class="section" id="rules-in-code">
<h2>Rules in Code<a class="headerlink" href="#rules-in-code" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ilao-events-module">
<h3>ilao_events module<a class="headerlink" href="#ilao-events-module" title="Permalink to this headline">¶</a></h3>
<p>Invokes the registration_settings_created event.  Do not migrate</p>
</div>
<div class="section" id="ilao-sms-surveys">
<h3>ilao_sms_surveys<a class="headerlink" href="#ilao-sms-surveys" title="Permalink to this headline">¶</a></h3>
<p>Invokes the rules component rules_potential_problem_with_surveys as part of a cron call</p>
</div>
<div class="section" id="ilao-toolbox">
<h3>ilao_toolbox<a class="headerlink" href="#ilao-toolbox" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Has custom action defined (create_new_toolbox_tickler_entity)</li>
<li>Custom code schedules tickler messages</li>
</ul>
</div>
<div class="section" id="ilao-user-utilities">
<h3>ilao_user_utilities<a class="headerlink" href="#ilao-user-utilities" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Defines custom actions for first time login and domain check</li>
<li>Invokes the first time login event</li>
</ul>
</div>
<div class="section" id="ilao-workbench">
<h3>ilao_workbench<a class="headerlink" href="#ilao-workbench" title="Permalink to this headline">¶</a></h3>
<p>Invokes rules component based on the workbench state:
* rules_send_publish_notification
* rules_send_content_review_notification
* rules_send_content_copyedit_notification</p>
<p>end</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="otis_drupal8.html" class="btn btn-neutral float-right" title="OTIS Drupal 8" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="migration_contexts.html" class="btn btn-neutral" title="Contexts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ILAO.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>