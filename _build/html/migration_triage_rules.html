

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Triage Rules &mdash; ILAO Drupal 8 3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OTIS Referrals" href="migration_oas_referrals.html" />
    <link rel="prev" title="OTIS Automated Notifications" href="migration_oas_notifications.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ILAO Drupal 8
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="migration.html">Migration Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="migration_users.html">Users and user profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_org_data.html">Migrating Organization Data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="migration_otis_entities.html">OTIS-related migration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="migration_oas_intake_settings.html">OAS Intake Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_triage_user.html">OAS Triage User</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_referral_history.html">OAS Referral History</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_legal_server.html">OAS Legal Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_financial_category.html">ILAO OAS Financial Category</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_income_standard.html">ILAO OAS Income Standard</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="migration_otis_functionality_overview.html">OTIS Functionality Documentation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="migration_oas_functionality.html">OTIS Global Items</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_permissions.html">OTIS Permissions</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_cron.html">OTIS Scheduled Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_glh.html">Get Legal Help Form to Next Step</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_intake_available.html">Intake Availability Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_intake_ui.html">OTIS Intake UI and Pre-Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_callbacks_and_confirms.html">Exit screens and Callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_etransfer.html">OTIS eTransfer Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_notifications.html">OTIS Automated Notifications</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Triage Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_referrals.html">OTIS Referrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_popup.html">OTIS Modal</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_widget.html">OTIS Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="migration_oas_surveys.html">OTIS Surveys</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="migration_oas_reporting.html">OTIS Reporting Functionality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migration_legal_content_types.html">Legal content migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_events.html">Event nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_jobs.html">Job content types</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_internships.html">Internships content type</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_other_node_types.html">Other node types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="otis_drupal8.html">OTIS Drupal 8</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO Drupal 8</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="migration.html">Migration Documentation</a> &raquo;</li>
        
          <li><a href="migration_otis_entities.html">OTIS-related migration</a> &raquo;</li>
        
          <li><a href="migration_otis_functionality_overview.html">OTIS Functionality Documentation</a> &raquo;</li>
        
      <li>Triage Rules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/migration_triage_rules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="triage-rules">
<h1>Triage Rules<a class="headerlink" href="#triage-rules" title="Permalink to this headline">¶</a></h1>
<p>Triage rules are a standard Drupal content type that has been integrated with Webform and adds some custom functionality to process.  Triage rules are essentially black boxes where ILAO’s platform has no understanding of the logic within them.</p>
<div class="section" id="content-type">
<h2>Content Type<a class="headerlink" href="#content-type" title="Permalink to this headline">¶</a></h2>
<p>The content type has a handful of fields.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="24%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Title</td>
<td>text field</td>
<td>Title for the triage rule</td>
</tr>
<tr class="row-odd"><td>Service(s)
(field_service)</td>
<td>entity reference</td>
<td>Services associated with the triage
rules; unlimited cardinality</td>
</tr>
<tr class="row-even"><td>Legal issue(s)
(field_legal_issues)</td>
<td>term reference</td>
<td>Legal issues tagged to the triage
rules; unlimited cardinality</td>
</tr>
<tr class="row-odd"><td>Groups audience
(og_group_ref)</td>
<td>Entity reference
Hidden</td>
<td>The organization associated with the
service(s); controls permission</td>
</tr>
</tbody>
</table>
<p>It also has the webform module attached to allow webforms to be created and attached to the content.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ilao_triage module provides some special handling for the node:</p>
<ul class="last simple">
<li>The og_group_ref is hidden in the ilao_triage_form_triage_rules_node_form_alter.</li>
<li>The ilao_triage_node_after_build function hides some additional settings from users.</li>
<li>ilao_triage_node_presave sets the organic group to the organization of the first service selected.  This then controls access to edit the triage rules.</li>
</ul>
</div>
</div>
<div class="section" id="webform-components-conditionals">
<h2>Webform Components &amp; Conditionals<a class="headerlink" href="#webform-components-conditionals" title="Permalink to this headline">¶</a></h2>
<p>The ilao_triage module makes changes to the default webform module for the triage rule form to simplify it for OTIS administrators.</p>
<div class="section" id="form-alteration">
<h3>Form alteration<a class="headerlink" href="#form-alteration" title="Permalink to this headline">¶</a></h3>
<p>Form alteration is located in ilao_triage.module in the ilao_triage_form_alter function.</p>
<p>For triage rules, the available types of form elements is different than for generic webforms.  The allowed form elements are:</p>
<ul class="simple">
<li>Date</li>
<li>Hidden; the hidden type allows a triage rules author to save data that is passed in the notes field of an eTransfer OR set an endpoint</li>
<li>Message; this is a markup element that displays to a user completing a set of program triage rules</li>
<li>Number; a text field that requires a numerical value</li>
<li>Radio; a single select option</li>
<li>Text input; a text field that has no validation</li>
<li>Yes/No; a radio single select option built using a custom webform component.  The yes/no component is defined in ilao_triage/components/yesno.inc.</li>
</ul>
</div>
<div class="section" id="custom-validation">
<h3>Custom validation<a class="headerlink" href="#custom-validation" title="Permalink to this headline">¶</a></h3>
<p>The ilao_triage_conditional_validate function provides a custom validation check to ensure that if there is a form element named ‘end point’, that it validates as one of the defined OTIS end points:</p>
<ul class="simple">
<li>intake (takes user to intake application)</li>
<li>divert (gives the user referrals)</li>
<li>bypass (gives user the bypass screen; no intake or referrals are provided)</li>
<li>pro bono (takes users to intake application but adds a note for pro bono placement)</li>
<li>self help line (takes users to intake application but adds a note to direct to self help line)</li>
</ul>
</div>
</div>
<div class="section" id="webform-processing">
<h2>Webform Processing<a class="headerlink" href="#webform-processing" title="Permalink to this headline">¶</a></h2>
<p>The ilao_triage_module processes the submitted triage rules webform.  This logic is in the ilao_triage_submit function.</p>
<div class="section" id="process">
<h3>Process<a class="headerlink" href="#process" title="Permalink to this headline">¶</a></h3>
<p>For each submitted form element, it adds appropriate values to a notes object that is then inserted into an etransfer packet:</p>
<ul class="simple">
<li>For yes/no elements, it adds the name of the form element and then Yes or No based on the user’s answer.</li>
<li>For radio elements, adds the submitted answer.  For example for the radio question “What’s your issue?” with options for “I had a cut in my food stamps, I received a letter that my food stamps are being terminated” and the user selects “I had a cut in my food stamps,” the notes object would include the text I had a cut in my food stamps</li>
<li>For hidden elements, other than those named end point or endpoint, the name of the form element and the hidden value are added to the notes.</li>
<li>For any other type, the name of the form element and then submitted value are added to the notes.</li>
</ul>
</div>
<div class="section" id="endpoint-processing">
<h3>Endpoint processing<a class="headerlink" href="#endpoint-processing" title="Permalink to this headline">¶</a></h3>
<p>A hidden field with a name of endpoint or end point is treated as the form element that controls routing of the triage rules through OTIS.</p>
<p>In all cases, the triage user entity is updated with the following:</p>
<ul class="simple">
<li>the last screen viewed is set to “Program triage”</li>
<li>the intake_created timestamp is set to the current timestamp</li>
<li>the changed timestamp is set to the current timestamp</li>
<li>the intake_status is set to the correct status (see specific endpoints below)</li>
<li>the triage_status is set to “Program triage_completed”</li>
<li>if county and state information has not yet been stored, the county and state are saved based on the zip code entered.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The saving of triage user data checks first that the oas_triage_user module is enabled and a triage_id is stored in a session variable.  For a user coming through the normal workflow, these will always be true.  If this check fails, an error is thrown directing the user to the main Get Legal Help page.</p>
</div>
<div class="section" id="endpoint-intake-pro-bono-or-self-help-line">
<h4>Endpoint: intake, pro bono or self help line<a class="headerlink" href="#endpoint-intake-pro-bono-or-self-help-line" title="Permalink to this headline">¶</a></h4>
<p>When the end point is intake, pro bono, or self help line:</p>
<ul class="simple">
<li>the user is redirected to the get-legal-help/intake page</li>
<li>the intake status is updated to “Offered”</li>
</ul>
<p>Endpoints of pro bono or self help line work just as any other form of intake except that:</p>
<ul class="simple">
<li>if the end point is pro bono, a note ” Route to pro bono” is added to the case notes.</li>
<li>if the end point is self help line, a note of ” Route to self-represented litigant help line” is added to the case notes.</li>
</ul>
</div>
<div class="section" id="endpoint-bypass">
<h4>Endpoint: bypass<a class="headerlink" href="#endpoint-bypass" title="Permalink to this headline">¶</a></h4>
<p>Bypass is designed to tell the user not to apply online but to call the program directly and should be used for high priority cases.  When the end point is set to bypass:</p>
<ul class="simple">
<li>the user is redirected to the get-legal-help/bypass page</li>
<li>the intake status is updated to “Bypass intake”</li>
</ul>
</div>
<div class="section" id="endpoint-divert">
<h4>Endpoint: divert<a class="headerlink" href="#endpoint-divert" title="Permalink to this headline">¶</a></h4>
<p>Diversion happens when a user answers triage rules in such a way that the program is not going to take their case.  When that happens:</p>
<ul class="simple">
<li>if program triage rules exist for a different program, the user is directed to their triage rules.</li>
<li>if no other program triage rules exist for a different program, the user is given other referrals and directed to the /get-legal-help/referrals page.</li>
</ul>
<p>In either case:</p>
<ul class="simple">
<li>the intake status is set to Diverted</li>
<li>a record is entered in the oas_referral_history to log the diversion:<ul>
<li>the service ID is stored in the database</li>
<li>the reject reason is set to “intake diversion”</li>
<li>the reject date is set to the current timestamp.</li>
</ul>
</li>
</ul>
<p>We did not start logging this information until 1/24/2018.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Our intention was to capture all instances where a user was offered a second chance intake.  This was probably not the best approach as it logs every intake diversion and not just those that resulted in a secondary intake.</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="migration_oas_referrals.html" class="btn btn-neutral float-right" title="OTIS Referrals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="migration_oas_notifications.html" class="btn btn-neutral" title="OTIS Automated Notifications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ILAO.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>